Starting script
non debug mode and not nirvana - setting local_train_data to False
2025-03-05 00:25:18.864 | INFO     | __main__:main:413 - Global rank 0, local rank 0, device: 0
2025-03-05 00:25:18.867 | INFO     | __main__:main:417 - Process group initialized
2025-03-05 00:25:18.867 | INFO     | __main__:main:433 - Using dist with rank 0 (only rank 0 will log)
2025-03-05 00:25:18.868 | INFO     | __main__:main:434 - ****************************************
2025-03-05 00:25:18.868 | INFO     | __main__:main:435 - Starting training with the arguments
2025-03-05 00:25:18.868 | INFO     | __main__:main:437 - model_config                   configs/llama_130m.json
2025-03-05 00:25:18.868 | INFO     | __main__:main:437 - use_hf_model                   False
2025-03-05 00:25:18.868 | INFO     | __main__:main:437 - batch_size                     128
2025-03-05 00:25:18.868 | INFO     | __main__:main:437 - eval_batch_size                256
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - gradient_accumulation          4
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - total_batch_size               512
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - max_length                     256
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - optimizer                      aid_sign_sgd
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - lr                             0.001
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - scheduler                      cosine
2025-03-05 00:25:18.869 | INFO     | __main__:main:437 - scheduler_cycle_length         None
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - scheduler_min_power            -20
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - min_lr_ratio                   0.1
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - activation_checkpointing       False
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - eval_every                     2000
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - num_training_steps             100000
2025-03-05 00:25:18.870 | INFO     | __main__:main:437 - max_train_tokens               None
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - save_every                     1000
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - general_save_dir               checkpoints
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - save_dir                       130m/opt-aid_sign_sgd-dtype-fp32-amp-1-bs-512-sch-cosine-warmup-10000-wd-0.001-lr-0.001-clip-1.0-l_inf-100.0-d_0-None-lb-0.0-clamp-0.001-gap-10-seed-0
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - save_dir_prefix                130m
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - tags                           None
2025-03-05 00:25:18.871 | INFO     | __main__:main:437 - dtype                          torch.float32
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - amp                            True
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - workers                        8
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - seed                           0
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - name                           test
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - grad_clipping                  1.0
2025-03-05 00:25:18.872 | INFO     | __main__:main:437 - wandb_tags                     ['aid_sign_sgd', 'fp32', 'amp', 'bs_512', 'sch_cosine', 'wd_0.001', 'lr_0.001', 'clip-1.0', 'l_inf_100.0', 'option2', 'seed_0']
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - wandb_name_prefix              None
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - run_final_eval                 True
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - run_old_eval                   False
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - final_save                     False
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - wandb                          True
2025-03-05 00:25:18.873 | INFO     | __main__:main:437 - debug                          False
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - debug_train_data               False
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - debug_print                    False
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - compile                        True
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - attn_implementation            sdpa
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - fsdp                           False
2025-03-05 00:25:18.874 | INFO     | __main__:main:437 - cpu_offload                    False
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - mp_policy_param                torch.float32
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - mp_policy_reduce               torch.float32
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - mp_policy_buffer               torch.float32
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - use_orig_params                False
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - proj_params_lr_scale           1.0
2025-03-05 00:25:18.875 | INFO     | __main__:main:437 - update_gap                     10
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - density                        0.25
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - reset_statistics               True
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - inactive_update_rule           sign_sgd
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - inactive_lr_scale              1.0
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - proj_norms                     True
2025-03-05 00:25:18.876 | INFO     | __main__:main:437 - proj_embeds                    True
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - proj_logits                    False
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - rank                           0
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - proj_side                      std
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - proj_type                      svd
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - coord_choice                   columns
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - block_order                    random
2025-03-05 00:25:18.877 | INFO     | __main__:main:437 - apollo_proj                    random
2025-03-05 00:25:18.878 | INFO     | __main__:main:437 - apollo_scale_type              tensor
2025-03-05 00:25:18.878 | INFO     | __main__:main:437 - apollo_scale                   1.0
2025-03-05 00:25:18.878 | INFO     | __main__:main:437 - apollo_scale_front             False
2025-03-05 00:25:18.878 | INFO     | __main__:main:437 - ldadam_rho                     0.908
2025-03-05 00:25:18.878 | INFO     | __main__:main:437 - ldadam_proj_method             power_iteration
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - ldadam_error_feedback          False
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - fira_alpha                     1.0
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - delay_start_step               10000
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - grad_taylor_approx             False
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - taylor_linear_coef             1.0
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - measure_time                   False
2025-03-05 00:25:18.879 | INFO     | __main__:main:437 - collect_grads                  False
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - weight_decay                   0.001
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - warmup_steps                   10000
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - beta1                          0.9
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - beta2                          0.999
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - eps                            1e-08
2025-03-05 00:25:18.880 | INFO     | __main__:main:437 - momentum                       0.0
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - nesterov                       False
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - dampening                      0
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - sgd_sign_update                False
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - sign_norm                      False
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - normalized                     False
2025-03-05 00:25:18.881 | INFO     | __main__:main:437 - l_inf                          100.0
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - d_0                            None
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - lower_bound                    0.0
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - clamp_level                    0.001
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - single_gpu                     False
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - local_train_data               False
2025-03-05 00:25:18.882 | INFO     | __main__:main:437 - streaming                      True
2025-03-05 00:25:18.883 | INFO     | __main__:main:437 - wandb_name                     opt-aid_sign_sgd-dtype-fp32-amp-1-bs-512-sch-cosine-warmup-10000-wd-0.001-lr-0.001-clip-1.0-l_inf-100.0-d_0-None-lb-0.0-clamp-0.001-gap-10-seed-0
2025-03-05 00:25:18.883 | INFO     | __main__:main:438 - ****************************************
/home/rinya/anaconda3/envs/sign-sgd-env/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly as `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation
  warnings.warn(
